(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{500:function(s,a,n){"use strict";n.r(a);var t=n(14),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("最近接触了Docker，玩一下利用Docker构建容器，这个容器包含了JDK1.8和Tomcat服务器，文章里面的Collector和Monitor的jar包、war包单纯只是为了验证JDK环境、Tomcat服务器是否能正常运行而已，别无他用。整理一下知识笔记，方便下次查阅。")]),s._v(" "),n("h1",{attrs:{id:"利用-dockerfile-构建自己的镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#利用-dockerfile-构建自己的镜像"}},[s._v("#")]),s._v(" 利用 Dockerfile 构建自己的镜像")]),s._v(" "),n("h2",{attrs:{id:"第一步-准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一步-准备工作"}},[s._v("#")]),s._v(" 第一步——准备工作")]),s._v(" "),n("p",[s._v("在 "),n("code",[s._v("/usr/local")]),s._v(" 目录下新建 "),n("code",[s._v("docker")]),s._v(" 文件夹")]),s._v(" "),n("ul",[n("li",[s._v("新建 "),n("code",[s._v("Dockerfile")]),s._v(" 文件")]),s._v(" "),n("li",[s._v("将 "),n("code",[s._v("JDK1.8")]),s._v(" 和 "),n("code",[s._v("tomcat8")]),s._v(" 的压缩包提取到 "),n("code",[s._v("/usr/local/docker")]),s._v(" 目录下，并分别更名为 "),n("code",[s._v("jdk1.8")]),s._v(" 和 "),n("code",[s._v("tomcat8")])]),s._v(" "),n("li",[s._v("上传"),n("code",[s._v("collector")]),s._v("和"),n("code",[s._v("monitor")]),s._v("的"),n("code",[s._v("war")]),s._v("包、"),n("code",[s._v("jar")]),s._v("包，各自所需的配置文件")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" docker\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" Dockerfile\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225214010.png",alt:""}})]),s._v(" "),n("h2",{attrs:{id:"第二步-编写文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编写文件"}},[s._v("#")]),s._v(" 第二步——编写文件")]),s._v(" "),n("p",[s._v("编写 "),n("code",[s._v("Dockerfile")]),s._v(" 文件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" Dockerfile\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定基础镜像")]),s._v("\nFrom ubuntu\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建者")]),s._v("\nMAINTAINER zzx\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#工作目录")]),s._v("\nWORKDIR /root\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将宿主机Dockerfile当前目录下的jdk目录下的文件添加至镜像容器的/opt目录下，并改名为jdk")]),s._v("\nADD jdk1.8 /opt/jdk\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将宿主机Dockerfile当前目录下的tomcat8目录下的文件添加至镜像的/opt目录下，并改名为tomcat")]),s._v("\nADD tomcat8 /opt/tomcat8\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置JDK环境变量")]),s._v("\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/jdk\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JRE_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/jre\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLASSPATH")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JRE_HOME")]),s._v("/lib:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLASSPATH")]),s._v("\nENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/sbin:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#新建配置文件的文件夹")]),s._v("\nRUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" pi\nRUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" pi\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" wsp\nRUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" wsp\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" collector\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" shell \nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" jar\nRUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传配置文件")]),s._v("\nADD collector /home/pi/wsp/collector/collector\nADD config /home/pi/config\nADD cd2000init_v3 /home/pi/wsp/cd2000init_v3\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传Collector的jar包")]),s._v("\nADD Collector-all.jar /home/pi/wsp/jar/Collector-all.jar\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传执行Collectorjar包的脚本")]),s._v("\nCOPY collector.sh /home/pi/wsp/jar/\nRUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" /home/pi/wsp/jar/collector.sh\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Monitor的war包放在tomcat下的webapps下，不用再上传")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#执行collector.sh")]),s._v("\nRUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~\nRUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/pi/wsp/jar\nCMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"collector.sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置公开端口")]),s._v("\nEXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置启动命令")]),s._v("\nENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/tomcat8/bin/catalina.sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"run"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br")])]),n("p",[s._v("在"),n("code",[s._v("/usr/local/docker")]),s._v("目录下新建一个脚本文件,命名为"),n("code",[s._v("collector.sh")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#jar包文件路径及名称（目录按照各自配置）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("APP_NAME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/pi/wsp/jar/Collector-all.jar\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查询进程，并杀掉当前jar/java程序")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("id")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" $APP_NAME "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $2}'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9 "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$pid")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$pid")]),s._v('进程终止成功"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#判断jar包文件是否存在，如果存在启动jar包，并时时查看启动日志")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -e "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$APP_NAME")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'文件存在,开始启动此程序...'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动jar包，指向日志文件，2>&1 & 表示打开或指向同一个日志文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" java -jar "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$APP_NAME")]),s._v(" \n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$APP_NAME 启动成功...'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$APP_NAME 文件不存在,请检查。'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h2",{attrs:{id:"第三步-构建容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三步-构建容器"}},[s._v("#")]),s._v(" 第三步——构建容器")]),s._v(" "),n("p",[s._v("构建命令格式：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker build -t 容器名:版本号 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("PS：版本号后要空一格，在加一个英文的小数点")])]),s._v(" "),n("p",[s._v("在"),n("code",[s._v("Dockerfile")]),s._v("的目录下执行如下命令：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker build -t docker:0.5 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("终端出现如下信息表示构建成功：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Sending build context to Docker daemon  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("589")]),s._v(".8MB\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" From ubuntu\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" f643c72bc252\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" MAINTAINER zzx\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" dc49c0692f34\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" WORKDIR /root\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 380860a682b4\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ADD jdk1.8 /opt/jdk\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" a8f36e2a7f05\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ADD tomcat8 /opt/tomcat8\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ede1318972d6\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/jdk\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 95074f69fa5b\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JRE_HOME")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/jre\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c3cfe2b55be3\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLASSPATH")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JRE_HOME")]),s._v("/lib:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CLASSPATH")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 2ae0c5a711c8\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENV "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/sbin:"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 0ce51f63d830\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 81577b7f1b43\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" pi\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c62b55c4b3e8\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" pi\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ba3d8b3bfe2b\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" wsp\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 3d6b309749c3\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" wsp\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c5a24cf47385\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" collector\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 8cda5d67e04a\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" shell\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Using cache\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 5e9355a33c4b\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" jar\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 5448dbd14af2\nRemoving intermediate container 5448dbd14af2\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" a7360732be9b\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" b157b20e2545\nRemoving intermediate container b157b20e2545\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 00619bdeeb50\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ADD collector /home/pi/wsp/collector/collector\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 7fe9e028953b\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ADD config /home/pi/config\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 027dec1998e7\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ADD cd2000init_v3 /home/pi/wsp/cd2000init_v3\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" dab7c54f498f\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ADD Collector-all.jar /home/pi/wsp/jar/Collector-all.jar\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 928207063cbd\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" COPY collector.sh /home/pi/wsp/jar/\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ecfb89b4a1b8\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" /home/pi/wsp/jar/collector.sh\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 787c7797f7ea\nRemoving intermediate container 787c7797f7ea\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" f00b5f1c162a\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" d29a81008606\nRemoving intermediate container d29a81008606\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 9e5a5a3552eb\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" RUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/pi/wsp/jar\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 3d4c33dbb8cf\nRemoving intermediate container 3d4c33dbb8cf\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" c513c756d807\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" CMD "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"collector.sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"daemon off"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 62b9d172e1c1\nRemoving intermediate container 62b9d172e1c1\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" afe4bbd1ea73\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" EXPOSE "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" c99d7142478d\nRemoving intermediate container c99d7142478d\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 4e38633312ca\nStep "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("/29 "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ENTRYPOINT "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/tomcat/bin/catalina.sh"')]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"run"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Running "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" 86263414e6a9\nRemoving intermediate container 86263414e6a9\n ---"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 276db8259e6e\nSuccessfully built 276db8259e6e\nSuccessfully tagged docker:0.5\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225214219.png",alt:""}})]),s._v(" "),n("h2",{attrs:{id:"第四步-运行容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第四步-运行容器"}},[s._v("#")]),s._v(" 第四步——运行容器")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker run -d -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10085")]),s._v(":8080 docker:0.5\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("第一个"),n("code",[s._v("10082")]),s._v("端口为本地主机的端口，第二个"),n("code",[s._v("8080")]),s._v("端口为容器的端口")]),s._v(" "),n("p",[s._v("参数说明：")]),s._v(" "),n("p",[n("code",[s._v("-d")]),s._v("：后台运行容器，并返回容器ID")]),s._v(" "),n("p",[n("code",[s._v("-p")]),s._v(": 指定端口映射，格式为：主机(宿主)端口:容器端口")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225214527.png",alt:""}})]),s._v(" "),n("p",[s._v("这里使用后台运行容器，可以使用命令打印运行日志")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("docker container logs [container ID or NAMES]\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"第五步-导出容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第五步-导出容器"}},[s._v("#")]),s._v(" 第五步——导出容器")]),s._v(" "),n("p",[s._v("导出本地容器命令：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先查看容器")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -a\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#再用命令导出")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CONTAINER ID"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" hello.tar\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225214818.png",alt:""}})]),s._v(" "),n("p",[s._v("导出的容器在当前目录下：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225214852.png",alt:""}})]),s._v(" "),n("h2",{attrs:{id:"第六步-导出镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第六步-导出镜像"}},[s._v("#")]),s._v(" 第六步——导出镜像")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("docker  save  -o  tar包的名字  镜像名\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"第七步-上传阿里云docker仓库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第七步-上传阿里云docker仓库"}},[s._v("#")]),s._v(" 第七步——上传阿里云Docker仓库")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker login --username"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("你的阿里云用户名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" registry.cn-shenzhen.aliyuncs.com\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker tag "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ImageId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" registry.cn-shenzhen.aliyuncs.com/zhouzixin/docker1:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像版本号"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker push registry.cn-shenzhen.aliyuncs.com/zhouzixin/docker1:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像版本号"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#registry.cn-shenzhen.aliyuncs.com/zhouzixin/docker1:更改为你的阿里云Docker仓库地址")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"第八步-过程中碰见的错误"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第八步-过程中碰见的错误"}},[s._v("#")]),s._v(" 第八步——过程中碰见的错误")]),s._v(" "),n("h3",{attrs:{id:"docker镜像源问题-导致拉取失败"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像源问题-导致拉取失败"}},[s._v("#")]),s._v(" Docker镜像源问题，导致拉取失败")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225214956.png",alt:""}})]),s._v(" "),n("ul",[n("li",[s._v("本身网速太慢，无法下载；")]),s._v(" "),n("li",[s._v("在Docker容器中配置的镜像有误，或镜像太水")])]),s._v(" "),n("p",[s._v("把"),n("code",[s._v("Docker")]),s._v("的镜像源更改为国内源的即可。")]),s._v(" "),n("p",[s._v("步骤：")]),s._v(" "),n("p",[s._v("修改或新建"),n("code",[s._v("/etc/docker/daemon.json")]),s._v("文件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/docker         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入/etc/docker目录下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" daemon.json   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改daemon.json")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("更改为：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn"]\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("注意，一定要保证该文件符合 "),n("code",[s._v("json")]),s._v(" 规范，否则 "),n("code",[s._v("Docker")]),s._v(" 将不能启动。")]),s._v(" "),n("p",[s._v("之后重新启动服务。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart docker\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("检查加速器是否生效：")]),s._v(" "),n("p",[s._v("执行 "),n("code",[s._v("$ docker info")]),s._v("，如果从结果中看到了如下内容，说明配置成功。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("Registry Mirrors:\n https://docker.mirrors.ustc.edu.cn\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225215356.png",alt:""}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225215419.png",alt:""}})]),s._v(" "),n("p",[s._v("参考链接：")]),s._v(" "),n("ul",[n("li",[s._v("https://blog.csdn.net/yyj108317/article/details/105875582")]),s._v(" "),n("li",[s._v("https://www.jianshu.com/p/34d3b4568059")])]),s._v(" "),n("h3",{attrs:{id:"端口占用问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#端口占用问题"}},[s._v("#")]),s._v(" 端口占用问题")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225215526.png",alt:""}})]),s._v(" "),n("p",[s._v("宿主机的"),n("code",[s._v("8080")]),s._v("已被占用，"),n("code",[s._v("Dockerfile")]),s._v("中换一个。")]),s._v(" "),n("h3",{attrs:{id:"dockerfile-文件配置书写错误"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-文件配置书写错误"}},[s._v("#")]),s._v(" Dockerfile 文件配置书写错误")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225215648.png",alt:""}})]),s._v(" "),n("p",[n("code",[s._v("Dokcerfile")]),s._v("的第一行："),n("code",[s._v("FROM")]),s._v("的"),n("code",[s._v("debian")]),s._v("的d需要小写，"),n("code",[s._v("debian")]),s._v("后不要加版本号")]),s._v(" "),n("p",[s._v("换成"),n("code",[s._v("ubuntu")]),s._v("的也是一样的。")]),s._v(" "),n("h3",{attrs:{id:"小问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#小问题"}},[s._v("#")]),s._v(" 小问题")]),s._v(" "),n("p",[s._v("启动容器后，通过"),n("code",[s._v("docker ps")]),s._v(" 命令看到刚刚启动的容器没在运行，再通过"),n("code",[s._v("docker ps -a")]),s._v("命令，看到我们刚刚启动的容器，启动之后就退出了。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225215748.png",alt:""}})]),s._v(" "),n("p",[s._v("接着通过"),n("code",[s._v("docker logs -f -t --tail 20 [容器ID]")]),s._v("看一下容器退出的原因")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225215828.png",alt:""}})]),s._v(" "),n("p",[s._v("这个错误，主要是由于不兼容引起的。主要包括几种不兼容：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("硬件架构不兼容。在 "),n("code",[s._v("amd")]),s._v(" 和 "),n("code",[s._v("arm")]),s._v(" 架构下构建的镜像很有可能不能互通。")]),s._v(" "),n("p",[s._v("解决办法：针对不同的硬件架构构建不同的镜像，或者构建跨架构（"),n("code",[s._v("multi-arch")]),s._v("）的镜像。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("shell")]),s._v(" 执行不兼容。脚本可能是基于 "),n("code",[s._v("bash")]),s._v(" 写的，不同的 "),n("code",[s._v("shell")]),s._v(" 解释器存在不兼容的情况，而有些 "),n("code",[s._v("Linux")]),s._v(" 发行版可能没有 "),n("code",[s._v("bash")]),s._v("，或者默认的 "),n("code",[s._v("shell")]),s._v(" 解释器不是 "),n("code",[s._v("bash")]),s._v("。")]),s._v(" "),n("p",[s._v("解决办法：在 "),n("code",[s._v("shell")]),s._v(" 脚本的开头指定需要使用的解释器，比如"),n("code",[s._v("#!/bin/bash")]),s._v("，并且注意使用的语法。")])]),s._v(" "),n("li",[n("p",[s._v("存在非 "),n("code",[s._v("*NIX")]),s._v(" 环境的换行符。比如在 "),n("code",[s._v("Windows")]),s._v(" 环境下编写的一些代码，移植到 "),n("code",[s._v("Linux")]),s._v(" 环境下可能会出问题。")])])]),s._v(" "),n("p",[s._v("我看了下执行"),n("code",[s._v("collector jar")]),s._v("包的"),n("code",[s._v("collector.sh")]),s._v("文件，该文件开头的"),n("code",[s._v("#!/bin/bash")]),s._v("有错！换成"),n("code",[s._v("#!/bin/sh")])]),s._v(" "),n("h3",{attrs:{id:"删除容器与删除镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除容器与删除镜像"}},[s._v("#")]),s._v(" 删除容器与删除镜像")]),s._v(" "),n("p",[s._v("删除容器步骤：（要先停止再删除）")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看正在运行的容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止正在运行的容器")]),s._v("\ndocker container stop "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CONTAINER ID"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#再查看容器是否已经停止了")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有容器，包括停止的容器")]),s._v("\ndocker "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除已停止的容器")]),s._v("\ndocker container "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("CONTAINER ID"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("删除镜像步骤：（要先删除使用镜像的容器，再删除镜像）")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先删除容器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看镜像")]),s._v("\ndocker images\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#再用删除命令")]),s._v("\ndocker image "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("IMAGE ID"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先用命令查看所有本地镜像，检查是否删除成功")]),s._v("\ndocker images\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果出现不同的镜像有相同的IMAGE ID，则用下面的命令删除镜像")]),s._v("\ndocker image "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" REPOSITORY:TAG\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"构建镜像时命令不对"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像时命令不对"}},[s._v("#")]),s._v(" 构建镜像时命令不对")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Willis-zzx/PicGO/img/20201225215929.png",alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);